"use strict";const url="https://studenter.miun.se/~maaf2200/writeable/dt173g/Projekt/webbservice/rest.php";function init(){getData()}window.onload=init;const order=document.getElementById("order"),liEl=document.getElementsByClassName("orderdish"),submit_order=document.getElementById("submit_order"),order_name=document.getElementById("name"),order_number=document.getElementById("phonenr"),order_time=document.getElementById("time");function stripTags(e){return e.replace(/<\/?[^>]+>/gi,"")}async function getData(){try{const e=await fetch(url);if(200!==e.status)return;const n=await e.json();writeMenu(n.filter((e=>void 0!==e.dishName)))}catch(e){console.log(e)}}function writeMenu(e){const n=document.getElementById("menu");n.innerHTML="",e.forEach((e=>{n.innerHTML+=`\n        <li id="${e.id}" class="dish">\n          <b>${e.dishName}</b><br> \n          ${e.dishContents}<br>\n          ${e.dishPrice} kr \n        </li>\n      `}));const r=document.getElementsByClassName("dish");Array.from(r).forEach((e=>{e.addEventListener("click",addDishToOrder)})),submit_order.addEventListener("click",confirm_order)}function addDishToOrder(e){const n=e.target.id,r=e.target.querySelector("b").innerText,t={id:n,name:r};order.innerHTML+=`<b class="orderdish" id=${n}>${r}<br></b>`,Array.from(liEl).forEach((e=>{e.addEventListener("click",deleteDish)})),orderContent.push(t)}function deleteDish(e){const n=e.target;1==confirm("Denna rätt tas bort från din beställning")&&n.remove()}function confirm_order(){const e=Array.from(order.querySelectorAll("b")).map((e=>e.innerText));""!=order_name.value&&""!=order_number.value&&""!=order_time.value&&""!=e?1==confirm(`Bekräfta följande beställning: \n          Namn: ${order_name.value}\n          Telefonnummer: ${order_number.value}\n          Tid för pickup: ${order_time.value}\n          Beställning: ${e}`)&&sendOrder(order_name.value,order_number.value,order_time.value,e):alert("Varning! viktig information saknas för att du ska kunna lägga denna beställning. \nVänligen försök igen!")}function sendOrder(e,n,r,t){const o=new FormData;o.append("name",e),o.append("phoneNumber",n),o.append("time",r),o.append("food",JSON.stringify(t)),fetch(url,{method:"POST",body:o}).then((e=>e.json())).then((e=>getData())).catch((e=>console.log(e))),console.log(e,n,r,t)}